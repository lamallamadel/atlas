groups:
  - name: atlas-backend
    rules:
      - alert: AtlasBackendInstanceDown
        expr: up{job="atlas-backend"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Atlas backend down"
          description: "Prometheus cannot scrape atlas-backend for > 1m."

      - alert: AtlasBackendHigh5xxRate
        expr: |
          sum(rate(http_server_requests_seconds_count{job="atlas-backend", outcome="SERVER_ERROR"}[5m]))
          /
          sum(rate(http_server_requests_seconds_count{job="atlas-backend"}[5m]))
          > 0.05
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High 5xx rate"
          description: "5xx ratio > 5% over 5m."
